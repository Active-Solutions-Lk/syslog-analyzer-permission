==========================================
ANALYZER SERVER SETUP SCRIPT
==========================================

ℹ This script will configure the Analyzer server environment.

Do you want to continue? [y/N]: y

ℹ Checking and installing dependencies...
122 packages can be upgraded. Run 'apt list --upgradable' to see them.
ℹ Installing mariadb-client...
✓ mariadb-client installed successfully
✓ bc is already installed
✓ net-tools is already installed
✓ php-cli is already installed
✓ php-mysql is already installed

ℹ Creating database user and granting privileges...
⚠ WARNING: Root authentication required. Please enter root password:
Enter password:
✓ Database user created and privileges granted

ℹ Verifying database 'analyzer' exists...
✗ ERROR: Database 'analyzer' does not exist
Do you want to create it? [y/N]: y
Enter password:
ERROR 1007 (HY000) at line 1: Can't create database 'analyzer'; database exists
✗ ERROR: Failed to create database

ℹ Creating 'log_mirror' table in 'analyzer' database...
Enter password:
ERROR 1050 (42S01) at line 3: Table 'log_mirror' already exists
✗ ERROR: Failed to create table

ℹ Setting up cron job for dynamic_incremental_transfer.sh...
✓ Cron job installed to run every minute.
ℹ Logs will be written to /var/www/html/syslog-analyzer-permission/logs/cron_output.log

ℹ Creating quick command aliases...
✓ Quick command aliases added to /root/.bashrc

==========================================
SETUP COMPLETE - SUMMARY
==========================================

Analyzer Server Configuration:
  Database: analyzer
  Table: log_mirror
  User: ruser

Automation:
  ✓ Dependencies installed (php, mysql-client, bc, net-tools)
  ✓ Cron job configured (runs every minute)
  ✓ Script: /var/www/html/syslog-analyzer-permission/dynamic_incremental_transfer.sh

Quick Commands (reload shell with 'source ~/.bashrc'):
  \033[0;34msync-now\033[0m      - Manually trigger sync
  \033[0;34msync-logs\033[0m     - View latest 10 logs from DB
  \033[0;34msync-status\033[0m   - Tail the cron output log

✓ Analyzer setup completed successfully!
root@analyzer-virtual-machine:/var/www/html/syslog-analyzer-permission#
